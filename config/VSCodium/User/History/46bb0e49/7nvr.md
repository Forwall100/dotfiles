[[работа]]
## Введение и знакомство
- Привет! Меня зовут Илья, я Дата инженер в команде центра данных и отчетности. И мы ищем в нашу команду стажера.
- (Импровизация: Кратко о себе).
- Расскажи, пожалуйста, немного о себе: где учишься, какой опыт уже есть, что интересного делал(а)
- (Импровизация: Уточняющие вопросы по рассказу кандидата, чтобы лучше понять его бэкграунд).

## Объяснение специфики команды и роли (10-15 минут)
- Хочу теперь сразу подробно рассказать про специфику именно _нашей_ команды, чтобы у тебя было полное понимание.
- Важный момент: **мы не занимаемся разработкой моделей машинного обучения** или классическим Data Science. Наша команда сфокусирована на части **работы с данными** для поддержки моделей.
- Основная часть наших задач — это **сбор и подготовка данных для мониторинга моделей машинного обучения.** То есть, мы строим пайплайны, которые регулярно обновляют данные, на которых затем наши коллеги из валидации проверяют насколько релевантные результаты выдает модель. Так же в скоуп нашей ответственности входит проверка качества данных - полнота, отсутствие аномалий, сравнение новых выборок с предыдущими и тд.
- И из этого плавно вытекает следующий набор задач, которыми мы занимаемся - это разработка внутренних инструментов, которые помогают датаинженерам автоматически проверять качество данных. (Рассказать вкратце про лдлиб)
- Технологический стек, с которым мы работаем, это в основном **Python, SQL, PySpark и HDFS**
- Учитывая все это, скажи, насколько тебе интересно было бы заниматься именно такими **инженерными задачами**, связанными с данными для ML, а не самим моделированием?


## Обсуждение организационных моментов
- Еще пара слов об организации работы. Основная часть команды находится в Москве. Мы с несколькими коллегами, и стажеры работаем в Новосибирске.
- Из-за разницы во времени и для лучшей синхронизации с московской командой, некоторые из нас начинает рабочий день позже обычного, ориентировочно в 13:00 по Новосибирску.
- Это не требование, просто расскажи как тебе было бы удобно?
- Так же мы ищем стажера именно на полный рабочий день, т.е. 40 часов в неделю, тебе это будет нормально?

## Техничка

### SQL
Давай теперь немного поговорим про технические навыки. Начнем с SQL. Он у нас используется очень активно. Представь себе такие таблицы:

- `events` (События системы мониторинга)
    - `event_id` (INT, PK) - ID события
    - `model_id` (INT) - ID модели, к которой относится событие
    - `event_type` (VARCHAR) - Тип события ('prediction', 'data_error', 'metric_alert')
    - `event_timestamp` (TIMESTAMP) - Время события
    - `value` (FLOAT) - Некоторое значение (например, метрика качества)
- `models` (Информация о моделях)
    - `model_id` (INT, PK) - ID модели
    - `model_name` (VARCHAR) - Название модели
    - `deployment_date` (DATE) - Дата развертывания модели

1. Напиши SQL-запрос, который вернет `event_id` и `event_timestamp` для всех событий типа 'data_error', относящихся к модели с названием 'credit_scoring'
```sql
SELECT
    e.event_id,
    e.event_timestamp
FROM
    events e
JOIN
    models m ON e.model_id = m.model_id
WHERE
    m.model_name = 'credit_scoring'
    AND e.event_type = 'data_error';
```

2. Напиши SQL-запрос, который посчитает количество событий каждого типа (`event_type`) для `model_id = 15`
```sql
SELECT
    event_type,
    COUNT(*) AS event_count
FROM
    events
WHERE
    model_id = 15
GROUP BY
    event_type;
```

3. Напиши SQL-запрос, который выведет название каждой модели (`model_name`) и количество 'metric_alert' событий для неё.
```sql
SELECT
    m.model_name,
    COUNT(e.event_id) AS alert_count
FROM
    events e
JOIN
    models m ON e.model_id = m.model_id
WHERE
    e.event_type = 'metric_alert'
GROUP BY
    m.model_name;
```

4. Напиши SQL-запрос, который найдет `model_id` всех моделей, у которых было _более 100_ событий типа 'prediction' после '2025-04-01'.
```sql
SELECT
    model_id
FROM
    events
WHERE
    event_type = 'prediction'
    AND event_timestamp > '2025-04-01'
GROUP BY
    model_id
HAVING
    COUNT(*) > 100;
```

### Python
У нас есть список словарей, описывающих события:
```python
events_list = [
  {'id': 1, 'model': 'A', 'type': 'prediction', 'value': 0.95},
  {'id': 2, 'model': 'B', 'type': 'data_error', 'details': 'missing value'},
  {'id': 3, 'model': 'A', 'type': 'prediction', 'value': 0.88},
  {'id': 4, 'model': 'A', 'type': 'metric_alert', 'value': 0.75}
]
```

Если человек будет брать элементы из словаря без .get(), предложить новый список, где в некоторых словарях не будет ключа 'model'.

